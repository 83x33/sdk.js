!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("axios"),require("socket.io-client")):"function"==typeof define&&define.amd?define(["axios","socket.io-client"],t):e.sdk33=t(e.axios,e.io)}(this,function(e,t){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;const n={},i={},o={};return n.options={appUrl:"https://www.8333.io",apis:{mainnet:"https://api.8333.io",testnet:"https://testnet.8333.io"}},n.apiUrl=((e="mainnet")=>n.options.apis[e]),n.client=((t="mainnet")=>(i[t]=i[t]||e.create({baseURL:n.apiUrl(t)}),i[t])),n.chain=((e="mainnet")=>t(`${n.apiUrl(e)}/${e}`,{transports:["websocket"]})),n.setOptions=(e=>n.options={...n.options,...e}),n.createInvoice=((e,t)=>new Promise((i,o)=>n.client(e.network||t).post("/invoices",e).then(e=>i(e.data)).catch(e=>o(e.message||e)))),n.payInvoice=((e,t,i=((e,t)=>{}))=>{"string"==typeof e&&(e={id:e}),"function"==typeof t&&(i=t,t={});const o=n.widget(e,t).onStatus(e=>i(e,o));return!1!==t.show&&o.show(),o}),n.payNewInvoice=((e,t,i=((e,t)=>{}))=>{"string"==typeof e&&(e={wid:e}),"function"==typeof t&&(i=t,t={}),n.createInvoice(e).then(e=>{const o=n.widget(e);o.onStatus(e=>i(e,o)),!1!==t.show&&o.show()}).catch(e=>console.log("[sdk33:err]",e))}),n.widgets=(()=>o),n.widget=((e,{preloadIframe:t=!0,network:i="mainnet",theme:s="dark"}={})=>{if(!(e="string"==typeof e?{id:e}:e||{}).id)throw new Error("No invoice provided");i=e.network||i;const{appUrl:a,apis:r}=n.options,d=(r[i],a+"/invoice/"+e.id+"?"+["network="+i,"theme="+s,"framed=true"].join("&")),c={inited:!1,containerId:"sdk33-"+e.id,id:e.id+"-frame",events:{}},l={body:document.getElementsByTagName("body")[0],container:document.getElementById(c.containerId),frame:document.getElementById(c.id),css:document.getElementById("sdk33-css")},p=function(e){const t=e.data;if("close"==t)return c.close();c.emit("data",t)};return c.init=function(){var e;if(c.inited||(e=p,window.addEventListener?window.addEventListener("message",e):window.attachEvent&&window.attachEvent("onmessage",e)),c.inited=!0,!l.css){l.css=document.createElement("style");let e="";e+=".sdk33-overlay {",e+="transition:320ms opacity ease;transition:320ms opacity ease;",e+="-webkit-transition:320ms opacity ease;transition:320ms opacity ease;",e+="display: none;position: fixed;",e+="overflow-y: scroll;-webkit-overflow-scrolling: touch;",e+="top: 0px;left: 0px;right: 0px;bottom: 0px;",e+="background-color: rgba(0, 0, 0, 0.8);",e+="z-index: 9999;",e+="}",e+=".sdk33-frame {",e+="min-height: 100%;height: 100%;",e+="width: 100%;",e+="}",l.css.innerHTML=e,l.body.appendChild(l.css)}return l.frame=document.createElement("iframe"),l.frame.id=c.id,l.frame.className="sdk33-frame",l.frame.src=d,l.frame.setAttribute("frameborder","0"),l.frame.setAttribute("allowtransparency","true"),l.frame.setAttribute("scrolling","yes"),l.overlay=document.createElement("div"),l.overlay.id=c.containerId,l.overlay.className="sdk33-overlay",l.overlay.appendChild(l.frame),l.body.appendChild(l.overlay),o[c.containerId]=c,c},c.show=function(){return c.inited?(l.overlay.style.display="inline-block",setTimeout(function(){l.overlay.style.opacity=1},200),c):c.init().show()},c.close=function(){return l.overlay.style.opacity=0,setTimeout(function(){l.overlay.style.display="none"},200),c},c.emit=function(e,t){return c.events[e]&&c.events[e](t),c},c.on=function(e,t){return c.events[e]=t,c},c.onStatus=function(e){return c.on("data",t=>e(t.status)),c},t&&c.init(),c}),n});
